let changePassword={initialise:(void 0,async()=>{try{await global.initialise()}catch(e){return}changePassword.initEventListeners(),removeLoader();const[e,r]=changePassword.collectURLInputs();changePassword.processURLInputs(e,r)}),initEventListeners:(void 0,()=>{document.getElementById("change-password-email").addEventListener("keypress",(function(e){"Enter"===e.key&&changePassword.sendCode()})),document.getElementById("change-password-confirm-new-password").addEventListener("keypress",(function(e){"Enter"===e.key&&changePassword.process()}))}),collectURLInputs:(void 0,()=>{const e=window.location.href.toString().split("/"),r=e.indexOf("change-password");return[e[r+1],e[r+2]]}),processURLInputs:(void 0,async(e,r)=>{let o;if(!e)return document.querySelector("#change-password-email-error").innerHTML="",document.querySelector("#change-password-send-code").removeAttribute("disabled");if(document.querySelector("#change-password-email").value=e,!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase()))return document.querySelector("#change-password-email-error").innerHTML="invalid email",document.querySelector("#change-password-send-code").removeAttribute("disabled");try{o=(await axios.post("/change-password/validate-email",{email:e})).data}catch(e){o={status:"error",content:e}}return"error"===o.status?window.location.assign("/change-password"):"failed"===o.status?(document.querySelector("#change-password-email-error").innerHTML=o.content,document.querySelector("#change-password-send-code").removeAttribute("disabled")):(document.querySelector("#change-password-page-one").classList.add("left"),document.querySelector("#change-password-page-two").classList.remove("right"),r&&(document.querySelector("#change-password-code").value=r),document.querySelector("#change-password-change-password").removeAttribute("disabled"),document.querySelector("#change-password-resend-code").removeAttribute("disabled"))}),sendCode:(void 0,async()=>{document.querySelector("#change-password-send-code").setAttribute("disabled","");const e=document.querySelector("#change-password-email").value;let r;if(!e)return document.querySelector("#change-password-email-error").innerHTML="email required",document.querySelector("#change-password-send-code").removeAttribute("disabled");if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase()))return document.querySelector("#change-password-email-error").innerHTML="invalid email",document.querySelector("#change-password-send-code").removeAttribute("disabled");document.querySelector(".full-page-message").innerHTML="Emailing your code",showLoader();try{r=(await axios.post("/change-password/send-code",{email:e})).data}catch(e){r={status:"error",content:e}}return"error"===r.status?window.location.assign("/change-password"):"failed"===r.status?(removeLoader(),document.querySelector("#change-password-email-error").innerHTML=r.content,document.querySelector("#change-password-send-code").removeAttribute("disabled")):(removeLoader(),document.querySelector("#change-password-page-one").classList.add("left"),document.querySelector("#change-password-page-two").classList.remove("right"),document.querySelector("#change-password-change-password").removeAttribute("disabled"),document.querySelector("#change-password-resend-code").removeAttribute("disabled"))}),process:(void 0,async()=>{const e=document.querySelector("#change-password-email").value,r=document.querySelector("#change-password-code").value,o=document.querySelector("#change-password-new-password").value,s=document.querySelector("#change-password-confirm-new-password").value;let t,a="",n="",d="",c="",i=!0;if(e?/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())||(i=!1,a="Invalid email"):(i=!1,a="Email required"),r||(i=!1,n="Code required"),o?changePassword.scorePassword(o)?(o.includes(" ")||o.includes("'")||o.includes('"'))&&(i=!1,d="Password cannot contain quotation marks or spaces"):(i=!1,d="Invalid password"):(i=!1,d="New password required"),s?o!==s&&(i=!1,c="Passwords do not match"):(i=!1,c="Confirm new password"),!i)return document.querySelector("#change-password-email-error").innerHTML=a,document.querySelector("#change-password-code-error").innerHTML=n,document.querySelector("#change-password-new-password-error").innerHTML=d,void(document.querySelector("#change-password-confirm-new-password-error").innerHTML=c);document.querySelector(".full-page-message").innerHTML="Changing your password",showLoader();try{t=(await axios.post("/change-password/process",{email:e,code:r,password:o})).data}catch(e){t={status:"error",content:e}}return"error"===t.status?window.location.assign("/change-password"):"failed"===t.status?(t.content.errorEmail&&(document.querySelector("#change-password-page-one").classList.remove("left"),document.querySelector("#change-password-page-two").classList.add("right")),document.querySelector("#change-password-email-error").innerHTML=t.content.errorEmail,document.querySelector("#change-password-code-error").innerHTML=t.content.errorCode,document.querySelector("#change-password-new-password-error").innerHTML=t.content.errorPassword,document.querySelector("#change-password-send-code").removeAttribute("disabled"),removeLoader()):(document.querySelector(".full-page-message").innerHTML="Password changed successfully",setTimeout(()=>document.querySelector(".full-page-message").innerHTML="Redirecting to login page",1e3),void setTimeout(()=>window.location.assign("/login"),2e3))}),scorePassword:(void 0,(e="")=>{let r=document.querySelector("#change-password-new-password-feedback");if(!e)return r.innerHTML="",r.style.color="red",!1;let o=0,s=new Object;for(let r=0;r<e.length;r++)s[e[r]]=(s[e[r]]||0)+1,o+=5/s[e[r]];let t={digits:/\d/.test(e),lower:/[a-z]/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)};variationCount=0;for(let e in t)variationCount+=1==t[e]?1:0;return o+=10*(variationCount-1),o>80?(r.innerHTML="Strong",r.style.color="LimeGreen",!0):o>60?(r.innerHTML="Moderate",r.style.color="Gold",!0):o>40?(r.innerHTML="Weak",r.style.color="orange",!0):(r.innerHTML="Very weak",r.style.color="red",!1)})};