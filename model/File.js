/*=========================================================================================
REQUIRED MODULES
=========================================================================================*/

const mongoose = require("mongoose");

/*=========================================================================================
VARIABLES
=========================================================================================*/

let GridFS;
const mongoAtlasURI = require("../config/database.js").mongoAtlasURI;
const gridFsStream = require("gridfs-stream");

/*=========================================================================================
SETUP GRIDFS
=========================================================================================*/

mongoose.createConnection(
  mongoAtlasURI,
  {
    useNewUrlParser: true,
    useCreateIndex: true,
    useUnifiedTopology: true
  },
  (error, client) => {
    GridFS = gridFsStream(client.db, mongoose.mongo);
    GridFS.collection("fs");
  }
);

/*=========================================================================================
EXPORT CUSTOMER MODEL
=========================================================================================*/

module.exports = GridFS;

/*=========================================================================================
END
=========================================================================================*/
