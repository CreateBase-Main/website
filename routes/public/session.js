/*=========================================================================================
REQUIRED MODULES
=========================================================================================*/

const express = require("express");

/*=========================================================================================
VARIABLES
=========================================================================================*/

const router = new express.Router();

/*=========================================================================================
MODELS
=========================================================================================*/

const Session = require("../../model/Session.js");

/*=========================================================================================
MIDDLEWARE
=========================================================================================*/

/*=========================================================================================
ROUTES
=========================================================================================*/

router.get("/session/create", async (req, res) => {
  // Retrieve Session ID
  const sessionId = req.sessionID;
  // Create Session
  let content;
  try {
    content = await Session.create(sessionId);
  } catch (error) {
    return res.send({ status: "failed", content: error });
  }
  res.send({ status: "success", content });
});

router.get("/session/save", async (req, res) => {
  req.session.cookie.expires = new Date(Date.now() + 1000 * 60 * 60 * 365);
  res.send({ status: "success", content: "session saved" });
});

router.get("/session/unsave", async (req, res) => {
  req.session.cookie.expires = false;
  res.send({ status: "success", content: "session unsaved" });
});

/*=========================================================================================
EXPORT ROUTE
=========================================================================================*/

module.exports = router;

/*=========================================================================================
END
=========================================================================================*/
